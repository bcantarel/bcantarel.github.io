<html>
<div class="WordSection1">
<p class="MsoNormal"><b><span style="font-size: 16.0pt; line-height: 107%; font-family: &quot;Arial&quot;,sans-serif; color: red;"># PART1 Practicing with Plots that We Discussed </span></b></p>

<p class="MsoNormal"><b><span style="font-size: 12.0pt; line-height: 107%; font-family: &quot;Arial&quot;,sans-serif; color: #00B050;"># PART1: This part is for you to practice every plot that we covered during the presentation, we will use the DIG NHLBT practicing data set (dig.csv) and data sets provided by R. </span></b></p>

<p class="MsoNormal"># Note, everything after # is a comment, R commands are in blue, you can copy the shaded blue commands into R to run.</p>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal"># <b><span style="font-size: 12.0pt; line-height: 107%; font-family: &quot;Arial&quot;,sans-serif; color: red;">load and read data sets for plotting</span></b><span style="color: red;"> </span></p>

<p class="MsoNormal"># check the available data sets</p>

<p class="MsoNormal" style=""><span style="color: blue;">data ()</span></p>

<p class="MsoNormal"># Go back to your R script and check details of a data set, iris for example</p>

<p class="MsoNormal" style=""><span style="color: blue;">str(iris)</span></p>

<p class="MsoNormal"># Read in external data</p>

<p class="MsoNormal"><b><span style="color: #00B050;"># we are going to use DIG NHLBT Teaching Dataset as an example, this data set will be used across this and the next session of the Nanocourse</span></b></p>

<p class="MsoNormal"># set up work directory first:</p>

<p class="MsoNormal" style=""><span style="color: blue;">setwd(&quot;C:/Users/xluo4/Desktop/RNanoCourse/DIG_csv&quot;) # refer to the first session of the workshop on setwd()</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">dig&lt;-read.csv(&quot;dig.csv&quot;)</span></p>

<p class="MsoNormal"># Check details of a data set</p>

<p class="MsoNormal" style=""><span style="color: blue;">str(dig)</span></p>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal">#<b><span style="font-size: 12.0pt; line-height: 107%; font-family: &quot;Arial&quot;,sans-serif; color: red;">Basic plotting by using build in graphics tools in R</span></b><span style="color: red;"> </span></p>

<p class="MsoNormal"># take a very simple data set &ldquo;Pressure&rdquo; as an example, check the structure of the data set</p>

<p class="MsoNormal" style=""><span style="color: blue;">str (pressure) </span></p>

<p class="MsoNormal"># since this data set only have two variables, R just map the first one to the x axis and the other one to the y axis</p>

<p class="MsoNormal" style=""><span style="color: blue;">plot (pressure)</span></p>

<p class="MsoNormal"># this is equivalent as</p>

<p class="MsoNormal" style=""><span style="color: blue;">plot (pressure$temperature, pressure$pressure)</span></p>

<p class="MsoNormal"># we are going to use this simple example to check the formatting option in build in graphics tools in R</p>

<p class="MsoNormal"># Plot Example 1</p>

<p class="MsoNormal"># scatter plot</p>

<p class="MsoNormal" style=""><span style="color: blue;">plot (pressure, type=&quot;p&quot;)</span></p>

<p class="MsoNormal"># scatter plot with different shape, size and color</p>

<p class="MsoNormal" style=""><span style="color: blue;">plot (pressure, type=&quot;p&quot;, pch = 8, cex =0.8, col=&quot;red&quot;)</span></p>

<p class="MsoNormal"># Plot Example 2</p>

<p class="MsoNormal"># line graph</p>

<p class="MsoNormal" style=""><span style="color: blue;">plot (pressure, type=&quot;l&quot;)</span></p>

<p class="MsoNormal"># line graph with different line type, width adn color</p>

<p class="MsoNormal" style=""><span style="color: blue;">plot (pressure, type=&quot;l&quot;, lty = 3, lwd =2, col=&quot;blue&quot;)</span></p>

<p class="MsoNormal"># add title</p>

<p class="MsoNormal" style=""><span style="color: blue;">plot (pressure, main=&quot;Relation&quot; )</span></p>

<p class="MsoNormal"># add text (parameter from statistics analysis or some other annotation)</p>

<p class="MsoNormal" style=""><span style="color: blue;">plot ( pressure )</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">text (150 ,200 , label =&quot; p value = 0.05 &quot;)</span></p>

<p class="MsoNormal">#plot for multiple groups</p>

<p class="MsoNormal" style=""><span style="color: blue;">data(iris)</span><span style="color: blue;"> # load iris data</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">pch.vec &lt;- c(2 ,8 ,21)[iris$Species]</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">col.vec &lt;- c(2 ,3 ,6)[iris$Species]</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">plot(iris$Sepal.Length , iris$Sepal.Width ,col = col.vec ,pch=pch.vec, xlab=&quot;sepal.length&quot;, ylab=&quot;sepal.width&quot;,main=&quot;iris&quot;)</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">legend (&quot;topleft&quot;, pch=c(2 ,8 ,21) ,col=c(2 ,3 ,6) ,legend = unique(iris$Species), cex=0.8)</span></p>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal">#<b><span style="font-size: 12.0pt; line-height: 107%; font-family: &quot;Arial&quot;,sans-serif; color: red;">Plot different graph types by build in R plotting tools and ggplot2 R package</span></b></p>

<p class="MsoNormal"># Install and load R package ggplot2</p>

<p class="MsoNormal"># ggplot2 is one of the most popular graphic packages in R, we are going to practice using it for different types of graphs.</p>

<p class="MsoNormal" style=""><span style="color: blue;">install.packages (&quot;ggplot2&quot;)</span></p>

<p class="MsoNormal"># load the library</p>

<p class="MsoNormal" style=""><span style="color: blue;">library(ggplot2)</span></p>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal"># <b><span style="font-size: 12.0pt; line-height: 107%; font-family: &quot;Arial&quot;,sans-serif; color: red;">Scatter Plots</span></b><span style="color: red;"> </span></p>

<p class="MsoNormal">#Scatter plots are frequently used to display the relationship between two continuous variables.</p>

<p class="MsoNormal">#simple basic plot</p>

<p class="MsoNormal" style=""><span style="color: blue;">plot(iris$Sepal.Length,iris$Sepal.Width ) </span>#check <span style="color: blue;">?plot </span>for more options for formatting the plot</p>

<p class="MsoNormal">#scatterplot in ggplot (geom_point())</p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(iris, aes(x=Sepal.Length, y=Sepal.Width)) + geom_point()</span> # check <span style="color: blue;">?geom_point </span>for more options, following are a few examples of changing the formatting</p>

<p class="MsoNormal"># change dot shape (default is #16) # please refer to the slide 16 on shape options</p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(iris, aes(x=Sepal.Length, y=Sepal.Width)) + </span></p>

<p class="MsoNormal" style=""><span style="color: blue;">geom_point(shape=21)</span></p>

<p class="MsoNormal"># change dot size (default is 2)</p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(iris, aes(x=Sepal.Length, y=Sepal.Width)) + </span></p>

<p class="MsoNormal" style=""><span style="color: blue;">geom_point(shape=21, size=2.5)</span></p>

<p class="MsoNormal"># add labels and change title position</p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(iris, aes(x=Sepal.Length, y=Sepal.Width)) + </span></p>

<p class="MsoNormal" style=""><span style="color: blue;">geom_point()+labs(x=&quot;Length&quot;,y=&quot;Width&quot;,title=&quot;Sepal Length and Width&quot;)+ </span></p>

<p class="MsoNormal" style=""><span style="color: blue;">theme(plot.title = element_text(hjust = 0.5))</span></p>

<p class="MsoNormal"># add lines from a fitted regression model to a scatter plot</p>

<p class="MsoNormal"># basic plot condition</p>

<p class="MsoNormal" style=""><span style="color: blue;">bp &lt;- ggplot(iris, aes(x=Sepal.Length, y=Sepal.Width))</span></p>

<p class="MsoNormal"># draw a scatter plot and add linear regression line</p>

<p class="MsoNormal" style=""><span style="color: blue;">bp + geom_point() + stat_smooth(method=lm)</span></p>

<p class="MsoNormal"># Default will show 95% confidence interval of the regression as shown in the shaded region</p>

<p class="MsoNormal"># showing 99% confidence interval instead</p>

<p class="MsoNormal" style=""><span style="color: blue;">bp + geom_point() + stat_smooth(method=lm, level=0.99)</span></p>

<p class="MsoNormal"># without showing confidence interval</p>

<p class="MsoNormal" style=""><span style="color: blue;">bp + geom_point() + stat_smooth(method=lm, se=FALSE)</span></p>

<p class="MsoNormal"># change regression line color</p>

<p class="MsoNormal" style=""><span style="color: blue;">bp + geom_point() + stat_smooth(method=lm, se=FALSE, colour=&quot;red&quot;)</span></p>

<p class="MsoNormal"># Default regression method is the loess (locally weighted polynomial) curve</p>

<p class="MsoNormal" style=""><span style="color: blue;">bp + geom_point() + stat_smooth()</span></p>

<p class="MsoNormal">#which equals</p>

<p class="MsoNormal" style=""><span style="color: blue;">bp + geom_point() + stat_smooth(method=loess)</span></p>

<p class="MsoNormal"># Now what if you want to separate the data points into different groups, for example group by &ldquo;Species&rdquo;</p>

<p class="MsoNormal"># grouping data points by a categorical variable by color and shape</p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(iris, aes(x=Sepal.Length, y=Sepal.Width, shape=Species, colour=Species)) + </span></p>

<p class="MsoNormal" style=""><span style="color: blue;">geom_point()</span></p>

<p class="MsoNormal"># add linear regression line</p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(iris, aes(x=Sepal.Length, y=Sepal.Width, shape=Species, colour=Species)) + </span></p>

<p class="MsoNormal" style=""><span style="color: blue;">geom_point() +</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">geom_smooth(method=lm, se=FALSE) </span></p>

<p class="MsoNormal"># if you don&#39;t like the default color and shape, you can set different shape and color for the grouping variables, please refer to the slide 16 on shape and color panel selection</p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(iris, aes(x=Sepal.Length, y=Sepal.Width, shape=Species, colour=Species)) + </span></p>

<p class="MsoNormal" style=""><span style="color: blue;">geom_point() +</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">scale_colour_brewer(palette=&quot;Dark2&quot;)+</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">scale_shape_manual(values=c(2,8,0))+</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">labs(x=&quot;Length&quot;,y=&quot;Width&quot;,title=&quot;Sepal Length and Width&quot;)+ </span></p>

<p class="MsoNormal" style=""><span style="color: blue;">theme(plot.title = element_text(hjust = 0.5))</span></p>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal"># <b><span style="font-size: 12.0pt; line-height: 107%; font-family: &quot;Arial&quot;,sans-serif; color: red;">Line Graphs</span></b><span style="color: red;"> </span></p>

<p class="MsoNormal"># Line Graph are used to visualize the trend over time or other continuous variables</p>

<p class="MsoNormal">#basic R plot</p>

<p class="MsoNormal" style=""><span style="color: blue;">plot(pressure$temperature, pressure$pressure, type=&quot;l&quot;)</span></p>

<p class="MsoNormal">#add points</p>

<p class="MsoNormal" style=""><span style="color: blue;">points(pressure$temperature, pressure$pressure)</span></p>

<p class="MsoNormal"># ggplot (geom_line())</p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(pressure, aes(x=temperature, y=pressure)) + geom_line()</span></p>

<p class="MsoNormal"># add points (geom_point())</p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(pressure, aes(x=temperature, y=pressure)) + geom_line() + geom_point()</span></p>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal"># <b><span style="font-size: 12.0pt; line-height: 107%; font-family: &quot;Arial&quot;,sans-serif; color: red;">Bar Graphs</span></b><span style="color: red;"> </span></p>

<p class="MsoNormal"># Bar Graphs are commonly used to display numeric values (y-axis) for different categories (x-axis)</p>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal"><b><span style="color: red;"># 1. Bar graph for exact value for y</span></b></p>

<p class="MsoNormal">#R build in bar graph</p>

<p class="MsoNormal" style=""><span style="color: blue;">barplot(BOD$demand, names.arg=BOD$Time, xlab=&quot;Time&quot;, ylab= &quot;demand&quot;, main=&quot;BOD&quot;, col=&quot;blue&quot;) </span># check <span style="color: blue;">?barplot </span>for more formatting options</p>

<p class="MsoNormal"># Use ggplot (geom_bar())</p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(BOD, aes(x=Time, y=demand)) + geom_bar(stat=&quot;identity&quot;) </span># check <span style="color: blue;">?geom_bar </span>for more formatting options</p>

<p class="MsoNormal"># Convert the x variable to a factor, so that it is treated as a discrete categorical variable instead of continuous numeric variable</p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(BOD, aes(x=factor(Time), y=demand)) + geom_bar(stat=&quot;identity&quot;)</span></p>

<p class="MsoNormal"># Change bar color and add labels</p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(BOD, aes(x=factor(Time), y=demand)) + geom_bar(stat=&quot;identity&quot;, fill=&quot;blue&quot;)+</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">labs(x=&quot;Time&quot;, y=&quot;demand&quot;, title=&quot;BOD&quot;)+</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">theme(plot.title = element_text(hjust = 0.5))</span></p>

<p class="MsoNormal"># Generate bar graphs for multiple groups</p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(ToothGrowth, aes(x=factor(dose), y=len, fill=supp))+</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">geom_bar(stat=&quot;identity&quot;,position=&quot;dodge&quot;, width=0.5)</span></p>

<p class="MsoNormal"># Make a stacked bar graph, just by leaving (position=&quot;dodge&quot;) out</p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(ToothGrowth,aes(x=factor(dose),y=len,fill=supp))+</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">geom_bar(stat=&quot;identity&quot;, width=0.5)</span></p>

<p class="MsoNormal"># Change width of the bar graph</p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(ToothGrowth,aes(x=factor(dose),y=len,fill=supp))+</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">geom_bar(stat=&quot;identity&quot;, width=0.5)</span></p>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal"><b><span style="color: red;"># 2. Bar graph for count of a categorical variable. </span>This is used more frequently than plotting for the exact value for y </b></p>

<p class="MsoNormal"># R build in plot, use table() to get the count of a variable</p>

<p class="MsoNormal" style=""><span style="color: blue;">barplot(table(mtcars$cyl), xlab=&quot;cyl&quot;, ylab=&quot;count&quot;, main=&quot;mtcars&quot;)</span></p>

<p class="MsoNormal"># ggplot</p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(mtcars, aes(x=factor(cyl))) + geom_bar(fill=&quot;blue&quot;,width=0.5)</span></p>

<p class="MsoNormal"># change the format of the bar graph and add labels</p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(mtcars, aes(x=factor(cyl))) + </span></p>

<p class="MsoNormal" style=""><span style="color: blue;">geom_bar(fill=&quot;blue&quot;,colour=&quot;black&quot;, width=0.5)+</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">labs(x=&quot;cyl&quot;, y=&quot;count&quot;, title=&quot;mtcars&quot;)+</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">theme(plot.title = element_text(hjust = 0.5))</span></p>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal"><b><span style="color: red;">#</span></b> <b><span style="color: red;">3. Plot for percentage of event of hospitalization .</span></b><span style="color: red;"> </span><b>*** this will be used to answer one of the questions in our practice</b></p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(dig, aes(x= factor(CVD), group=factor(TRTMT))) + </span></p>

<p class="MsoNormal" style=""><span style="color: blue;">geom_bar(aes(y = ..prop.., fill = factor(TRTMT)), stat=&quot;count&quot;, position=&quot;dodge&quot;)+</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">geom_text(aes(label = scales::percent(..prop..), y= ..prop.. ), </span></p>

<p class="MsoNormal" style=""><span style="color: blue;">stat= &quot;count&quot;,position=position_dodge(0.9), vjust = -.5) +</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">labs(x=&quot;CVD&quot;,y = &quot;Percent&quot;, fill=&quot;treatment&quot;) +</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">scale_y_continuous(labels=scales::percent)</span></p>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal"><b><span style="color: red;">#</span></b> <b><span style="color: red;">4.</span></b> <b><span style="color: red;">Plot mean and error bars</span></b></p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(ToothGrowth, aes(factor(dose), len )) + </span></p>

<p class="MsoNormal" style=""><span style="color: blue;">stat_summary(fun.y = mean, geom = &quot;bar&quot;, width=0.5, fill=&quot;lightgreen&quot;) + </span></p>

<p class="MsoNormal" style=""><span style="color: blue;">stat_summary(fun.data = mean_cl_normal, geom = &quot;errorbar&quot;, width=0.2)+</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">labs(x=&quot;dose&quot;, y=&quot;length&quot;)</span></p>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal"># <b><span style="font-size: 12.0pt; line-height: 107%; font-family: &quot;Arial&quot;,sans-serif; color: red;">Plots to summarize the data distribution</span></b><span style="color: red;"> </span></p>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal">#<b><span style="font-size: 12.0pt; line-height: 107%; font-family: &quot;Arial&quot;,sans-serif; color: red;">1. Histogram</span></b><span style="color: red;"> </span></p>

<p class="MsoNormal">#Histogram can be used to view the distribution of one-dimensional data</p>

<p class="MsoNormal">#R build in histogram</p>

<p class="MsoNormal" style=""><span style="color: blue;">hist(ChickWeight$weight) </span># check <span style="color: blue;">?hist </span>for more formatting options</p>

<p class="MsoNormal"># Specify number of bins with breaks</p>

<p class="MsoNormal" style=""><span style="color: blue;">hist(ChickWeight$weight, breaks=20)</span></p>

<p class="MsoNormal">#ggplot (geom_histogram)</p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(ChickWeight,aes(x=weight)) + geom_histogram() </span># check <span style="color: blue;">?geom_histogram </span>for more formatting options</p>

<p class="MsoNormal"># Specify number of bins</p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(ChickWeight,aes(x=weight)) +</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">geom_histogram(bins=20, fill=&quot;white&quot;, colour=&quot;black&quot;)</span></p>

<p class="MsoNormal"># histogram of multiple groups</p>

<p class="MsoNormal">#make the bars NOT stacked</p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(ChickWeight, aes(x=weight, fill=factor(Diet))) +</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">geom_histogram(position=&quot;identity&quot;)</span></p>

<p class="MsoNormal"># if you remove position=&quot;identity&quot;, the bars will stacked on top of each other, try leave it out and compare with the previous graph</p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(ChickWeight, aes(x=weight, fill=factor(Diet))) +</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">geom_histogram()</span></p>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal">#<b><span style="font-size: 12.0pt; line-height: 107%; font-family: &quot;Arial&quot;,sans-serif; color: red;">2. Density Curve</span></b><span style="color: red;"> </span></p>

<p class="MsoNormal">#density curves can also be used to view the distribution of the data with smoothing (geom_density())</p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(ChickWeight, aes(x=weight, fill=Diet)) + geom_density() </span># check <span style="color: blue;">?geom_density</span> for more formatting options</p>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal">#<b><span style="font-size: 12.0pt; line-height: 107%; font-family: &quot;Arial&quot;,sans-serif; color: red;">3. Boxplot</span></b><span style="color: red;"> </span></p>

<p class="MsoNormal"># R build in boxplot</p>

<p class="MsoNormal" style=""><span style="color: blue;">boxplot(weight~Diet, data=ChickWeight) </span># check <span style="color: blue;">?boxplot</span> for more formatting options</p>

<p class="MsoNormal">#ggplot (geom_boxplot())</p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(ChickWeight, aes(x=Diet, y=weight)) + geom_boxplot(fill=&quot;lightgreen&quot;) </span># check <span style="color: blue;">?geom_boxplot</span> for more formatting options</p>

<p class="MsoNormal"># add notches to boxplot</p>

<p class="MsoNormal"><span style="color: blue;">ggplot(ChickWeight, aes(x=Diet, y=weight)) + geom_boxplot(notch=TRUE)</span></p>

<p class="MsoNormal"># label mean on boxplot</p>

<p class="MsoNormal"><span style="color: blue;">ggplot(ChickWeight, aes(x=Diet, y=weight)) + geom_boxplot(fill=&quot;lightgreen&quot;,notch=TRUE)+</span></p>

<p class="MsoNormal"><span style="color: blue;">stat_summary(fun.y=&quot;mean&quot;,geom=&quot;point&quot;, fill=&quot;blue&quot;, shape=21, size=3)</span></p>

<p class="MsoNormal"># make a violin plot to compare density estimates of different groups</p>

<p class="MsoNormal"><span style="color: blue;">p &lt;- ggplot(ChickWeight, aes(x=Diet, y=weight))</span></p>

<p class="MsoNormal"><span style="color: blue;">p + geom_violin()</span></p>

<p class="MsoNormal"># include the boxplot in the middle of the violin plot to view the summary of the data</p>

<p class="MsoNormal"><span style="color: blue;">p + geom_violin() + </span></p>

<p class="MsoNormal"><span style="color: blue;">geom_boxplot(width=.1, fill=&quot;lightgreen&quot;, outlier.colour=NA) +</span></p>

<p class="MsoNormal"><span style="color: blue;">stat_summary(fun.y=mean, geom=&quot;point&quot;, fill=&quot;white&quot;, shape=21, size=3)</span></p>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal"># <b><span style="font-size: 12.0pt; line-height: 107%; font-family: &quot;Arial&quot;,sans-serif; color: red;">Change the appearance of the above graphs for publication or presentation</span></b><span style="color: red;"> </span></p>

<p class="MsoNormal"><b><span style="color: red;">### Polish the graph</span></b></p>

<p class="MsoNormal">#base plot</p>

<p class="MsoNormal" style=""><span style="color: blue;">bp &lt;- ggplot(iris, aes(x=Sepal.Length, y=Sepal.Width, color=Species, shape=Species))+geom_point()</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">bp</span></p>

<p class="MsoNormal"><b><span style="color: red;"># Change to black and white background</span></b></p>

<p class="MsoNormal" style=""><span style="color: blue;">bp1&lt;-bp + theme_bw()</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">bp1</span></p>

<p class="MsoNormal"><b><span style="color: red;"># remove grid lines</span></b></p>

<p class="MsoNormal" style=""><span style="color: blue;">bp2&lt;-bp1 + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">bp2</span></p>

<p class="MsoNormal"><b><span style="color: red;"># add labels</span></b></p>

<p class="MsoNormal" style=""><span style="color: blue;">bp3&lt;- bp2+labs(x=&quot;Length&quot;, y=&quot;Width&quot;, title=&quot;Sepal Length and Width&quot;)</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">bp3</span></p>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal"><b><span style="color: red;"># modify title and axis</span></b></p>

<p class="MsoNormal" style=""><span style="color: blue;">bp4&lt;- bp3 + </span></p>

<p class="MsoNormal" style=""><span style="color: blue;">theme(axis.title.x = element_text(colour=&quot;red&quot;, size=11, face=&quot;bold&quot;),</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">axis.text.x = element_text(colour=&quot;blue&quot;),</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">axis.title.y = element_text(colour=&quot;red&quot;, size=11,face=&quot;bold&quot;, angle = 90),</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">axis.text.y = element_text(colour=&quot;blue&quot;),</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">plot.title = element_text(colour=&quot;red&quot;, size=12, face=&quot;bold&quot;, hjust=0.5)) </span></p>

<p class="MsoNormal" style=""><span style="color: blue;">bp4</span></p>

<p class="MsoNormal"><b><span style="color: red;"># modify legends</span></b></p>

<p class="MsoNormal" style=""><span style="color: blue;">bp4 + </span></p>

<p class="MsoNormal" style=""><span style="color: blue;">theme(legend.background = element_rect(fill=&quot;grey85&quot;, colour=&quot;red&quot;, size=0.2),</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">legend.title = element_text(colour=&quot;blue&quot;, face=&quot;bold&quot;, size=11),</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">legend.text = element_text(colour=&quot;red&quot;),</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">legend.key = element_rect(colour=&quot;blue&quot;, size=0.2))</span></p>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal">#<b><span style="font-size: 12.0pt; line-height: 107%; font-family: &quot;Arial&quot;,sans-serif; color: red;">Output for publication or presentation </span></b></p>

<p class="MsoNormal"><b><span style="color: red;"># output to PNG</span></b></p>

<p class="MsoNormal"># Width and height are in pixels for PNG files</p>

<p class="MsoNormal" style=""><span style="color: blue;">png(&quot;myplot-%d.png&quot;, width=400, height=400)</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">plot(mtcars$wt, mtcars$mpg)</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(mtcars, aes(x=wt, y=mpg)) + geom_point()</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">dev.off()</span></p>

<p class="MsoNormal"><b><span style="color: red;"># output to TIFF</span></b></p>

<p class="MsoNormal"># Width and height are in pixels for TIFF files</p>

<p class="MsoNormal" style=""><span style="color: blue;">tiff(&quot;myplot-%d.tiff&quot;, width=400, height=400)</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">plot(mtcars$wt, mtcars$mpg)</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(mtcars, aes(x=wt, y=mpg)) + geom_point()</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">dev.off()</span></p>

<p class="MsoNormal"><b><span style="color: red;"># output to pdf files</span></b></p>

<p class="MsoNormal"># Width and height are in inches for pdf files</p>

<p class="MsoNormal" style=""><span style="color: blue;">pdf(&quot;myplot.pdf&quot;, width=4, height=4)</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">plot(mtcars$wt, mtcars$mpg)</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(mtcars, aes(x=wt, y=mpg)) + geom_point()</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">dev.off()</span></p>

<p class="MsoNormal"><b><span style="color: red;"># output to postscript files</span></b></p>

<p class="MsoNormal"># Width and height are in inches for postscript files</p>

<p class="MsoNormal" style=""><span style="color: blue;">postscript(&quot;myplot.eps&quot;, width=4, height=4)</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">plot(mtcars$wt, mtcars$mpg)</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(mtcars, aes(x=wt, y=mpg)) + geom_point()</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">dev.off()</span></p>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal"># <b><span style="font-size: 12.0pt; line-height: 107%; font-family: &quot;Arial&quot;,sans-serif; color: red;">Other Useful Plots</span></b><span style="color: red;"> </span></p>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal"># <b><span style="font-size: 12.0pt; line-height: 107%; font-family: &quot;Arial&quot;,sans-serif; color: red;">Pie Charts</span></b><span style="color: red;"> </span></p>

<p class="MsoNormal">#Pie Chart is used to simply check the composition of the data groups</p>

<p class="MsoNormal" style=""><span style="color: blue;">pie(table(iris$Species), col=rainbow(3)) </span># basic R plot, check <span style="color: blue;">?pie </span>for more options</p>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal"># <b><span style="font-size: 12.0pt; line-height: 107%; font-family: &quot;Arial&quot;,sans-serif; color: red;">Heat map </span></b></p>

<p class="MsoNormal"># heat maps are frequently used to visualize the level of signal of one variable across different time or groups</p>

<p class="MsoNormal"># this is going to be covered more in the RNAseq part of the workshop</p>

<p class="MsoNormal"># plot with R build in heatmap()# scale data to mean=0, sd=1 and convert to matrix</p>

<p style="margin: 0in; vertical-align: baseline;"><span style="font-size: 11.0pt; font-family: &quot;Calibri&quot;,sans-serif; color: #3333FF;">mtscaled &lt;- as.matrix(scale(mtcars)) </span></p>

<p style="margin: 0in; background: white; vertical-align: baseline;"><span style="font-size: 11.0pt; font-family: &quot;Calibri&quot;,sans-serif;"># create heatmap and don&#39;t reorder columns</span></p>

<p style="margin: 0in; vertical-align: baseline;"><span style="font-size: 11.0pt; font-family: &quot;Calibri&quot;,sans-serif; color: #3333FF;">heatmap(mtscaled, Colv=F, scale=&#39;none&#39;) </span></p>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal"># prepare time series data for heatmap for ggplot</p>

<p class="MsoNormal" style=""><span style="color: blue;">str(presidents)</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">pres_rating &lt;- data.frame(</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">rating = as.numeric(presidents),</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">year = as.numeric(floor(time(presidents))),</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">quarter = as.numeric(cycle(presidents)))</span></p>

<p class="MsoNormal">#draw heatmap</p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(pres_rating, aes(x=year, y=quarter, fill=rating))+geom_tile()</span></p>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal">#<b><span style="font-size: 12.0pt; line-height: 107%; font-family: &quot;Arial&quot;,sans-serif; color: red;">Venn Diagram</span></b><span style="color: red;"> </span></p>

<p class="MsoNormal">#Venn Diagrams are used to check the overlap between different data sets</p>

<p class="MsoNormal"># you can perform R programming to check the overlapping between the datasets and get the numbers for the weight</p>

<p class="MsoNormal" style=""><span style="color: blue;">install.packages(&quot;Vennerable&quot;)</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">library(Vennerable)</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">V &lt;- Venn(SetNames=c(&#39;A&#39;,&#39;B&#39;,&#39;C&#39;),Weight=c(0,10,30,5,20,2,16,1))</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">plot(V, doWeights=TRUE,type=&#39;circles&#39;)</span></p>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal"># <b><span style="font-size: 12.0pt; line-height: 107%; font-family: &quot;Arial&quot;,sans-serif; color: red;">Correlation Plot</span></b><span style="color: red;"> </span></p>

<p class="MsoNormal"># Correlation plot are used to check the association or similarity among variables</p>

<p class="MsoNormal"># make a correlation matrix</p>

<p class="MsoNormal" style=""><span style="color: blue;">mcor&lt;-cor(mtcars)</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">install.packages(&quot;corrplot&quot;)</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">library(corrplot)</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">corrplot(mcor, method=&quot;shade&quot;, shade.col=NA, tl.col=&quot;black&quot;, tl.srt=45) # check ?corrplot for more options</span></p>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal"><b><span style="font-size: 16.0pt; line-height: 107%; font-family: &quot;Arial&quot;,sans-serif; color: red;"># PART2. Hands on exercise on practicing clinical trial DIG data set </span></b></p>

<p class="MsoNormal"><b><span style="font-size: 12.0pt; line-height: 107%; font-family: &quot;Arial&quot;,sans-serif; color: #00B050;"># PART2: This part is for you to take what you have learned and try to generate plots on some practicing clinical trial data set</span></b></p>

<p class="MsoNormal" style=""><span style="color: blue;">library(ggplot2)</span></p>

<p class="MsoNormal"><b><span style="color: #00B050;"># we are going to use DIG NHLBT Teaching Dataset as an example, this data set will be used across the workshop</span></b></p>

<p class="MsoNormal"># load data</p>

<p class="MsoNormal" style=""><span style="color: blue;">setwd() # set up working directory to where dig.csv is located</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">dig &lt;-read.csv(&quot;dig.csv&quot;)</span></p>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal"><span style="color: black;">#</span><b><span style="font-size: 12.0pt; line-height: 107%; font-family: &quot;Arial&quot;,sans-serif; color: red;"> I. read the following questions and identify the graph types you are going to draw</span></b><span style="color: black;"> </span></p>

<p class="MsoNormal"><b><span style="font-size: 12.0pt; line-height: 107%; font-family: &quot;Arial&quot;,sans-serif; color: red;">&nbsp;</span></b></p>

<div style="padding: 1.0pt 4.0pt 1.0pt 4.0pt; background: white;">
<p class="MsoNormal" style="background: white; border: none; padding: 0in; padding-bottom: 1.0pt;"><b><span style="font-size: 12.0pt; line-height: 107%; font-family: &quot;Arial&quot;,sans-serif; color: #7030A0;"># Q1: Check the relationship between BMI and Systolic BP (SYSBP)</span></b></p>

<p class="MsoNormal" style="background: white; border: none; padding: 0in; padding-top: 1.0pt; padding-bottom: 1.0pt;"><b><span style="font-size: 12.0pt; line-height: 107%; font-family: &quot;Arial&quot;,sans-serif; color: #7030A0;"># Q2: plot the number of patients for different SEX groups </span></b></p>

<p class="MsoNormal" style="background: white; border: none; padding: 0in; padding-top: 1.0pt; padding-bottom: 1.0pt;"><b><span style="font-size: 12.0pt; line-height: 107%; font-family: &quot;Arial&quot;,sans-serif; color: #7030A0;"># Q3: use ggplot to check the distribution of AGE in different treatment groups (TRTMT) using three different types of plots</span></b></p>

<p class="MsoNormal" style="background: white; border: none; padding: 0in; padding-top: 1.0pt; padding-bottom: 1.0pt;"><b><span style="font-size: 12.0pt; line-height: 107%; font-family: &quot;Arial&quot;,sans-serif; color: #7030A0;"># Q4: A). use ggplot to plot the percentage of death (DEATH) in different treatment groups (TRTMT); </span></b></p>

<p class="MsoNormal" style="background: white; border: none; padding: 0in; padding-top: 1.0pt; padding-bottom: 1.0pt;"><b><span style="font-size: 12.0pt; line-height: 107%; font-family: &quot;Arial&quot;,sans-serif; color: #7030A0;"># B). use ggplot to plot the percentage of death attributed to worsening heart failure (DWHF) in different treatment groups (TRTMT)</span></b></p>

<p class="MsoNormal" style="background: white; border: none; padding: 0in; padding-top: 1.0pt;"><b><span style="font-size: 12.0pt; line-height: 107%; font-family: &quot;Arial&quot;,sans-serif; color: #7030A0;"># Q5: take plot from Q4B, try to polish the graph by changing the background into black and white, get rid of grid lines, add labels for x, y axis and plot title, adjust font and position for labels, and modify legends.</span></b></p>
</div>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal"># <b><span style="font-size: 12.0pt; line-height: 107%; font-family: &quot;Arial&quot;,sans-serif; color: red;">II. Check the clue and refer to the example code to see whether you can modify the example code to draw your plot to the question.</span></b><span style="color: red;"> </span></p>

<p class="MsoNormal">#<b><span style="color: red;">Clue for Q1:</span></b><span style="color: red;"> </span>Check the relationship between BMI and Systolic BP (SYSBP)</p>

<p class="MsoNormal"># graph type: <b><span style="color: #00B050;">scatter plot for relationship between two continuous variables (BMI and SYSBP)</span></b></p>

<p class="MsoNormal">#Example Code:</p>

<p class="MsoNormal"># R build in scatter plot</p>

<p class="MsoNormal" style=""><span style="color: blue;">plot(iris$Sepal.Length,iris$Sepal.Width, xlab=&quot;Length&quot;, ylab=&quot;Width&quot;,main = &quot;Sepal Length and Width&quot; ) </span></p>

<p class="MsoNormal">#scatterplot in ggplot (geom_point())</p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(iris, aes(x=Sepal.Length, y=Sepal.Width)) + geom_point()</span></p>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal">#<b><span style="color: red;">Clue for Q2:</span></b><span style="color: red;"> </span>plot the number of patients for different SEX groups</p>

<p class="MsoNormal"># graph type: <b><span style="color: #00B050;">bar graph for count of categorical variable SEX</span></b></p>

<p class="MsoNormal">#Example Code:</p>

<p class="MsoNormal"># R build in bargraph</p>

<p class="MsoNormal" style=""><span style="color: blue;">barplot(table(mtcars$cyl), xlab=&quot;cyl&quot;, ylab=&quot;count&quot;, main=&quot;mtcars&quot;)</span></p>

<p class="MsoNormal"># ggplot</p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(mtcars, aes(x=factor(cyl))) + geom_bar()</span></p>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal">#<b><span style="color: red;">Clue for Q3:</span></b><span style="color: red;"> </span>use ggplot to visualize the distribution of AGE in different treatment groups (TRTMT) using three different types of plots</p>

<p class="MsoNormal">#graph type: <b><span style="color: #00B050;">visualize the distribution of a continuous variable (AGE) by histogram, density curve and boxplot</span></b></p>

<p class="MsoNormal">#Example Code</p>

<p class="MsoNormal">#histogram</p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(ChickWeight, aes(x=weight, fill=factor(Diet))) + geom_histogram(position=&quot;identity&quot;)</span></p>

<p class="MsoNormal"># density curve (geom_density)</p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(ChickWeight, aes(x=weight, fill=factor(Diet))) + geom_density()</span></p>

<p class="MsoNormal"># boxplot</p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(ChickWeight, aes(x=factor(Diet), y=weight)) + geom_boxplot()</span></p>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal">#<b><span style="color: red;">Clue for Q4:</span></b> A). use ggplot to plot the percentage of death (DEATH) in different treatment groups (TRTMT);</p>

<p class="MsoNormal"># B). use ggplot to plot the percentage of death attributed to worsening heart failure (DWHF) in different treatment groups (TRTMT).</p>

<p class="MsoNormal"># graph type: <b><span style="color: #00B050;">bar graph for percentage of categorical variable</span></b>.</p>

<p class="MsoNormal">#We have done the following during the practice. Can you modify it to graph for different variables?</p>

<p class="MsoNormal">#Example Code</p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(dig, aes(x= factor(CVD), group=factor(TRTMT))) + </span></p>

<p class="MsoNormal" style=""><span style="color: blue;">geom_bar(aes(y = ..prop.., fill = factor(TRTMT)), stat=&quot;count&quot;, position=&quot;dodge&quot;)+</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">geom_text(aes( label = scales::percent(..prop..), y= ..prop.. ), stat= &quot;count&quot;,position=position_dodge(0.9), vjust = -.5) +</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">labs(x=&quot;CVD&quot;,y = &quot;Percent&quot;, fill=&quot;treatment&quot;) +</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">scale_y_continuous(labels=scales::percent)</span></p>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal">#<b><span style="color: red;">Clue for Q5:</span></b><span style="color: red;"> </span>take plot from Q4B in ggplot, try to polish the graph by changing the background into black and white, get rid of grid lines, add labels for x axis, y axis and plot title, adjust font and position for labels, and modify legend</p>

<p class="MsoNormal">#first run</p>

<p class="MsoNormal" style=""><span style="color: blue;">Q4B&lt;-ggplot(dig, aes(x= factor(DWHF), group=factor(TRTMT))) + </span></p>

<p class="MsoNormal" style=""><span style="color: blue;">geom_bar(aes(y = ..prop.., fill = factor(TRTMT)), stat=&quot;count&quot;, position=&quot;dodge&quot;)+</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">geom_text(aes( label = scales::percent(..prop..), y= ..prop.. ), stat= &quot;count&quot;, position=position_dodge(0.9), vjust = -.5) +</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">labs(x=&quot;DWHF&quot;,y = &quot;Percent&quot;, fill=&quot;treatment&quot;) +</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">scale_y_continuous(labels=scales::percent) </span></p>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal">#then follow the steps in <b><span style="color: #00B050;">Change the appearance of the above graphs for publication or presentation</span></b><span style="color: #00B050;"> </span></p>

<p class="MsoNormal"><b><span style="color: #00B050;"># polish the graph </span></b></p>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal"># <b><span style="font-size: 12.0pt; line-height: 107%; font-family: &quot;Arial&quot;,sans-serif; color: red;">III. Compare your code and plots with the Key</span></b><span style="color: red;"> </span></p>

<p class="MsoNormal"><b><span style="color: red;">#Key:</span></b></p>

<p class="MsoNormal"><b><span style="color: red;"># Q1: Check the relationship between BMI and Systolic BP (SYSBP)</span></b></p>

<p class="MsoNormal" style=""><span style="color: blue;">plot(dig$BMI,dig$SYSBP, xlab=&quot;BMI&quot;, ylab=&quot;SYSBP&quot;, col=&quot;blue&quot;)</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(dig, aes(x=BMI, y=SYSBP)) + geom_point(colour=&quot;blue&quot;, shape=21)</span></p>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal"><b><span style="color: red;"># Q2: plot the number of patients for different SEX groups</span></b></p>

<p class="MsoNormal" style=""><span style="color: blue;">barplot(table(dig$SEX), col=&quot;lightgreen&quot;)</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(dig, aes(x=factor(SEX))) + geom_bar( colour=&quot;black&quot;, fill=&quot;lightgreen&quot;, width=0.5)</span></p>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal" style=""><b><span style="color: red;"># Q3 use ggplot to check the distribution of AGE in different treatment groups (TRTMT) using three different types of plots</span></b></p>

<p class="MsoNormal"># histogram</p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(dig, aes(x=AGE, fill=factor(TRTMT))) + geom_histogram(position=&quot;identity&quot;)</span></p>

<p class="MsoNormal"># denstity curve</p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(dig, aes(x=AGE, fill=factor(TRTMT))) + geom_density()</span></p>

<p class="MsoNormal"># boxplot</p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(dig, aes(x=factor(TRTMT), y=AGE)) + geom_boxplot(notch=TRUE, width=0.5, colour=&quot;black&quot;, fill=&quot;lightgreen&quot;)+</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">stat_summary(fun.y=&quot;mean&quot;,geom=&quot;point&quot;, fill=&quot;white&quot;, shape=21, size=3)</span></p>

<p class="MsoNormal"># add a violin plot</p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(dig, aes(x=factor(TRTMT), y=AGE)) + geom_violin() + geom_boxplot(notch=TRUE, width=0.2, colour=&quot;black&quot;, fill=&quot;lightgreen&quot;)+</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">stat_summary(fun.y=&quot;mean&quot;,geom=&quot;point&quot;, fill=&quot;white&quot;, shape=21, size=3)</span></p>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal"><b><span style="color: red;"># Q4. A. use ggplot to plot the percentage of death (DEATH) in different treatment groups (TRTMT)</span></b></p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(dig, aes(x= factor(DEATH), group=factor(TRTMT))) + </span></p>

<p class="MsoNormal" style=""><span style="color: blue;">geom_bar(aes(y = ..prop.., fill = factor(TRTMT)), stat=&quot;count&quot;, position=&quot;dodge&quot;)+</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">geom_text(aes( label = scales::percent(..prop..), y= ..prop.. ), stat= &quot;count&quot;,position=position_dodge(0.9), vjust = -.5) +</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">labs(x=&quot;DEATH&quot;,y = &quot;Percent&quot;, fill=&quot;treatment&quot;) +</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">scale_y_continuous(labels=scales::percent)</span></p>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal"><b><span style="color: red;"># Q4.B. use ggplot to plot the percentage of death attributed to worsening heart failure (DWHF) in different treatment groups (TRTMT)</span></b></p>

<p class="MsoNormal" style=""><span style="color: blue;">ggplot(dig, aes(x= factor(DWHF), group=factor(TRTMT))) + </span></p>

<p class="MsoNormal" style=""><span style="color: blue;">geom_bar(aes(y = ..prop.., fill = factor(TRTMT)), stat=&quot;count&quot;, position=&quot;dodge&quot;)+</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">geom_text(aes( label = scales::percent(..prop..), y= ..prop.. ), stat= &quot;count&quot;,position=position_dodge(0.9), vjust = -.5) +</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">labs(x=&quot;DWHF&quot;,y = &quot;Percent&quot;, fill=&quot;treatment&quot;) +</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">scale_y_continuous(labels=scales::percent) </span></p>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal"><b><span style="color: red;"># Q5: take plot from Q4B, try to polish the graph by changing the background into black and white, get rid of grid lines, add labels for x axis, y axis and plot title, adjust font and position for labels, and modify legends.</span></b></p>

<p class="MsoNormal" style=""><span style="color: blue;">Q4B&lt;-ggplot(dig, aes(x= factor(DWHF), group=factor(TRTMT))) + </span></p>

<p class="MsoNormal" style=""><span style="color: blue;">geom_bar(aes(y = ..prop.., fill = factor(TRTMT)), stat=&quot;count&quot;, position=&quot;dodge&quot;)+</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">geom_text(aes( label = scales::percent(..prop..), y= ..prop.. ), stat= &quot;count&quot;,position=position_dodge(0.9), vjust = -.5) +</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">labs(x=&quot;DWHF&quot;,y = &quot;Percent&quot;, fill=&quot;treatment&quot;) +</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">scale_y_continuous(labels=scales::percent) </span></p>

<p class="MsoNormal" style=""><span style="color: blue;">Q4B+</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">theme_bw()+</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank())+</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">labs(x=&quot;DWHF&quot;, y=&quot;Percentage&quot;, title=&quot;Percentage of DWHF in Different Treatment Group&quot;) +</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">theme(axis.title.x = element_text(colour=&quot;red&quot;, size=11,face=&quot;bold&quot;),</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">axis.text.x = element_text(colour=&quot;blue&quot;),</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">axis.title.y = element_text(colour=&quot;red&quot;, size=11,face=&quot;bold&quot;, angle = 90),</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">axis.text.y = element_text(colour=&quot;blue&quot;),</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">plot.title = element_text(colour=&quot;red&quot;, size=12, face=&quot;bold&quot;, hjust=0.5)) +</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">theme(legend.background = element_rect(fill=&quot;grey85&quot;, colour=&quot;red&quot;, size=0.2),</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">legend.title = element_text(colour=&quot;blue&quot;, face=&quot;bold&quot;, size=11),</span></p>

<p class="MsoNormal" style=""><span style="color: blue;">legend.text = element_text(colour=&quot;red&quot;))</span></p>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal">&nbsp;</p>
</div>
</html>
